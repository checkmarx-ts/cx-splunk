{
    "dataSources": {
        "total_count_search": {
            "type": "ds.search",
            "options": { "query": "sourcetype=\"sast_scan_summary*\" latest=now | table distinct * |  stats COUNT AS (DISTINCT ProjectName)" }
        },
        "LOC_Count": {
            "type": "ds.search",
            "options": { "query": "sourcetype=\"sast_scan_summary*\" latest=now | table distinct * | stats sum(LinesOfCode) as LOC" }
        },
        "High_Severity": {
            "type": "ds.search",
            "options": { "query": "sourcetype=\"sast_scan_summary*\" latest=now | table distinct * | stats sum(High) as high" }
        },
        "Medium_Severity": {
            "type": "ds.search",
            "options": { "query": "sourcetype=\"sast_scan_summary*\" latest=now | table distinct * | stats sum(Medium) as medium" }
        },
        "Low_Severity": {
            "type": "ds.search",
            "options": { "query": "sourcetype=\"sast_scan_summary*\" latest=now | table distinct * | stats sum(Low) as low" }
        },
        "project_pies": {
            "type": "ds.search",
            "options": { "query": "sourcetype=sast_scan_summary* latest=now | table distinct * | eval totalvulns=(High+Medium+Low) | table ProjectName, totalvulns" }
        },
        "loc_timeline": {
            "type": "ds.search",
            "options": { "query": "sourcetype=\"sast_scan_summary*\" latest=now | table ScanFinished, LinesOfCode" }
        }
    },
    "inputs": {},
    "layout": {
        "type": "absolute",
        "options": { "width": 1600, "height": 1000, "display": "auto-scale" },
        "structure": [
            { "item": "sv_total_projects", "position": { "h": 150, "w": 150, "x": 20, "y": 20 } },
            { "item": "sv_loc_count", "position": { "h": 150, "w": 150, "x": 190, "y": 20 } },
            { "item": "sv_low_severity", "position": { "h": 150, "w": 150, "x": 360, "y": 20 } },
            { "item": "sv_medium_severity", "position": { "h": 150, "w": 150, "x": 530, "y": 20 } },
            { "item": "sv_high_severity", "position": { "h": 150, "w": 150, "x": 700, "y": 20 } },
            { "item": "sv_project_pies", "position": { "h": 250, "w": 770, "x": 800, "y": 290 } },
            { "item": "sv_loc_timeline", "position": { "h": 250, "w": 770, "x": 20, "y": 290 } }
        ]
    },
    "title": "Summary",
    "description": "",
    "visualizations": {
        "sv_total_projects": {
            "title": "On-Boarded projects",
            "type": "viz.singlevalue",
            "options": { "backgroundColor": "#53a051" },
            "dataSources": { "primary": "total_count_search" }
        },
        "sv_loc_count": {
            "title": "Scanned LOC",
            "type": "viz.singlevalue",
            "options": { "backgroundColor": "#dc4e41" },
            "dataSources": { "primary": "LOC_Count" }
        },
        "sv_high_severity": {
            "title": "High",
            "type": "viz.singlevalue",
            "options": { "backgroundColor": "#dc4e41" },
            "dataSources": { "primary": "High_Severity" }
        },
        "sv_medium_severity": {
            "title": "Medium",
            "type": "viz.singlevalue",
            "options": { "backgroundColor": "#f8be34" },
            "dataSources": { "primary": "Medium_Severity" }
        },
        "sv_low_severity": {
            "title": "Low",
            "type": "viz.singlevalue",
            "options": { "backgroundColor": "#294e70" },
            "dataSources": { "primary": "Low_Severity" }
        },
        "sv_project_pies": {
            "title": "Vulnerability distribution of High-Severity Vulnerabilities",
            "type": "viz.pie",
            "showPercentage": true,
            "dataSources": { "primary": "project_pies" }
        },
        "sv_loc_timeline": {
            "title": "Project Scans timeline (30 Days)",
            "type": "viz.area",
            "dataSources": { "primary": "loc_timeline" }
        }
    }
}
